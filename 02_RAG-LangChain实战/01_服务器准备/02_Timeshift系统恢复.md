

## 安装 Timeshift

默认情况下，Ubuntu 22.04 的仓库已包含 Timeshift，直接运行以下命令安装：

```bash
sudo apt update
sudo apt install timeshift
```

---

## 初始配置与备份设置

1. **启动 Timeshift**  
   通过应用菜单搜索并打开 Timeshift，输入密码授权。

2. **选择备份类型**  
   • **RSYNC**（推荐）：适用于所有文件系统（如 EXT4），通过增量备份节省空间，允许手动浏览备份文件。
   • **BTRFS**：仅适用于使用 BTRFS 文件系统的用户，依赖子卷快照功能，恢复速度更快。

3. **设置备份存储位置**  
   • 建议选择独立分区或外部存储设备（如移动硬盘），格式需为 **EXT4/NTFS**（NTFS 需安装 `ntfs-3g`）。
   • *注意：不支持网络路径或 FAT 格式设备* 。

4. **配置备份计划**  
   • 设置快照频率（每日/每周/每月）和保留数量（例如保留 5 个每日备份），避免占用过多空间。

5. **排除/包含目录**  
   • 默认排除 `/home` 目录（用户数据），如需备份个人文件需手动包含。
   • *建议单独备份用户数据（如使用 Deja Dup），避免系统恢复时覆盖最新文件* 。

---

## 执行备份

1. **手动创建快照**  
   点击 **Create** 立即生成快照，首次备份时间较长（取决于系统大小）。

2. **命令行操作**  

   ```bash
   # 创建带标签的备份（D=每日，O=手动）
   sudo timeshift --create --tags D --comments "首次备份"
   # 列出所有快照
   sudo timeshift --list
   # 删除指定快照
   sudo timeshift --delete --snapshot "2022-02-23_18-32-36"
   ```

   *（标签支持 `D/W/M/O` 分别对应日/周/月/手动备份）* 

---

## 恢复系统

1. **从图形界面恢复**  
   • 选择目标快照 → 点击 **Restore** → 按向导完成（默认恢复系统分区，保留 `/home` 数据）。

2. **系统崩溃时的恢复**  
   • 使用 Ubuntu Live USB 启动 → 安装 Timeshift → 挂载原系统分区 → 选择快照恢复。

3. **命令行恢复**  

   ```bash
   sudo timeshift --restore --snapshot '2022-02-23_18-32-36'
   ```

---

## 注意事项

1. **空间估算**  
   • 首次备份需占用与系统已用空间相近的存储（例如系统占用 20GB，备份需至少 25GB）。
   • 后续增量备份仅存储差异内容，空间占用较少。

2. **兼容性**  
   • BTRFS 模式需要系统分区使用 BTRFS 文件系统，且布局符合 Ubuntu 子卷标准（如 `@` 和 `@home`）。

3. **备份策略**  
   • 建议在系统更新、安装新软件前手动创建快照，确保可快速回滚。

---

通过以上步骤，你可以高效利用 Timeshift 保护 Ubuntu 系统，避免因配置错误或更新失败导致的数据丢失。